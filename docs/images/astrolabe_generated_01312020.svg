
<svg id="test" viewbox="0 0 210 210" 
     width="600" height="600"
     xmlns="http://www.w3.org/2000/svg" 
     xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" 
     xmlns:xlink="http://www.w3.org/1999/xlink"
     onload="init(evt)">
<defs>
    <style type="text/css">
        #diagramLabel {
          fill: black;
          text-anchor: end;
          font-size: 4px;
          stroke: none;
        }
        #crossHair{
          stroke: black;
          stroke-width: 1.2;
          stroke-opacity: 0.8;          
        }
        #tropicCircles {
          fill: none;
          stroke: black;
          stroke-width: 1;
          stroke-opacity: 0.3;
        }
        #tropicCircles:hover {
          fill: none;
          stroke: red;
          stroke-width: 1;
          stroke-opacity: 0.3;
        }
        #eclipticCircle {
          fill: none;
          stroke: gold;
          stroke-width: 2;
          stroke-opacity: 1;
        }
        #axisFigure {
          stroke: black;
          stroke-width: 1;
          stroke-opacity: 0.5;
        }
        #division {
          stroke: black;
          stroke-width: 1;
          stroke-opacity: 0.5;
        }
        #divisionBold {
          stroke: red;
          stroke-width: 1;
          stroke-opacity: 1;
        }
        #eclipticPole, #eclipticCenter {
          stroke: black;
          stroke-width: 1;
          stroke-opacity: 0.5;
        }
        #constructionLine, #constructionLine4 {
          stroke-dasharray: 2 2;
          stroke: black;
          stroke-width: 1;
          stroke-opacity: 0.5
        }
    </style>
    <clipPath id="equatorialHole" >
        <path  d="
            M0 65.63236000956694 
            A65.63236000956694 65.63236000956694 0 1 0 0 -65.63236000956694
            A65.63236000956694 65.63236000956694 0 1 0 0 65.63236000956694z "/>
    </clipPath>
    
    <clipPath id="eclipticExterior" >
        <path  d="
            M0 104.0 
            A75.53803340212701 75.53803340212701 0 1 0 0 -47.07606680425402
            A75.53803340212701 75.53803340212701 0 1 0 0 104.0z "/>
    </clipPath> 
    
    <clipPath id="eclipticHole">
        <path fill-rule="evenodd" d="
            M0.0 100.0
            A71.53803340212701 71.53803340212701 0 0 1 0.0 -43.07606680425402
            A71.53803340212701 71.53803340212701 0 0 1 0.0 100.0z
            M0.0 95.0
            A66.53803340212701 66.53803340212701 0 1 0 0.0 -38.07606680425402
            A66.53803340212701 66.53803340212701 0 1 0 0.0 95.0z"/>
    </clipPath>
    
    <clipPath id="hole" >
        <path id="test" fill-rule="evenodd" d="
            M-2 100 
            A100 100 0 1 0 0 -100
            A100 100 0 1 0 0 100z
            M-5,24.614408331209837 5,24.614408331209837 5,14.614408331209837 -5,14.614408331209837 -5,24.614408331209837 0,100

        "/>
    </clipPath>
</defs>

<g id="diagram" style="stroke:black; stroke-width: 1;" transform="translate(102, 102), scale(1, -1)">
    <title>Ecliptic Division</title>
    <g >
        <circle id="tropicCircles" cx="0" cy="0" r="100"/>
        <circle id="tropicCircles" cx="0" cy="0" r="65.63236000956694" />
        <circle id="tropicCircles" cx="0" cy="0" r="43.07606680425401"/>
        <text id="diagramLabel" style="text-anchor: start;" transform="scale(1,-1)"
              x="2" y="71.63236000956694">Equator</text>
    </g>
    
    <g id="cross">
        <line x1="0" y1="-1" x2="0" y2="1"/>
        <line x1="0" y1="-1" x2="0" y2="1"/>
    </g>
    
    <g id="axisFigure">
        <line x1="0" y1="-100" x2="0" y2="100"/>
        <line x1="-100" y1="0" x2="100" y2="0"/>
    </g>
    
    <g id="eclipticDiagram">
        <path id="eclipticCircle" d="
            M0 100.0
            A71.53803340212701 71.53803340212701 0 0 1 0.0 -43.07606680425402
            A71.53803340212701 71.53803340212701 0 0 1 0.0 100.0z"/>

        <g id="eclipticCenter">
            <line id="crossHair" x1="-5" y1="43.07606680425401" x2="5" y2="43.07606680425401"/>
            <line id="crossHair" x1="0" y1="38.07606680425401" x2="0" y2="48.07606680425401"/>
            <text id="diagramLabel" transform="scale(1,-1)"
                  x="-2" y="-45.07606680425401">Ecliptic Center</text>
        </g>

        <g id="eclipticPole">
            <line id="crossHair" x1="-5" y1="19.614408331209837" x2="5" y2="19.614408331209837"/>
            <line id="crossHair" x1="0" y1="14.614408331209837" x2="0" y2="24.614408331209837"/>
            <text id="diagramLabel" transform="scale(1,-1)"
                  x="-2" y="-21.614408331209837">Ecliptic Pole</text>
        </g>

        <g>
            <title>Divide Equator</title>
            <line id="division" x1="0" y1="61.63236000956694" x2="0" y2="65.63236000956694"/>
            
                <use xlink:href="#division" transform="rotate(0)"/>
                <use xlink:href="#division" transform="rotate(30)"/>
                <use xlink:href="#division" transform="rotate(60)"/>
                <use xlink:href="#division" transform="rotate(90)"/>
                <use xlink:href="#division" transform="rotate(120)"/>
                <use xlink:href="#division" transform="rotate(150)"/>
                <use xlink:href="#division" transform="rotate(180)"/>
                <use xlink:href="#division" transform="rotate(210)"/>
                <use xlink:href="#division" transform="rotate(240)"/>
                <use xlink:href="#division" transform="rotate(270)"/>
                <use xlink:href="#division" transform="rotate(300)"/>
                <use xlink:href="#division" transform="rotate(330)"/>
                <use xlink:href="#division" transform="rotate(360)"/>
        </g>

        <g>
            <line id="constructionLine" style="clip-path: url(#eclipticExterior);" 
                  x1="0" 
                  y1="19.614408331209837" 
                  x2="86.60254037844388" 
                  y2="49.99999999999999"/>

            <line id="constructionLine4" x1="0" y1="0" 
                  x2="69.80635994999166" 
                  y2="44.10684862286893" />
        </g>

        <g style="clip-path: url(#eclipticHole)">
            <title>Divide Ecliptic</title>

            
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="62.7416338553867" 
                                             y2="-5.906297894248713"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="71.49294375045773" 
                                             y2="31.00149744779938"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="53.26386249574163" 
                                             y2="76.2181303370027"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="0.0" 
                                             y2="100.0"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="-53.26386249574159" 
                                             y2="76.21813033700275"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="-71.49294375045771" 
                                             y2="31.001497447799622"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="-62.74163385538673" 
                                             y2="-5.906297894248663"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="-43.36825574182792" 
                                             y2="-28.431658853096902"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="-21.67249393934792" 
                                             y2="-39.71422594389901"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="0.0" 
                                             y2="-43.07606680425402"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="21.672493939347852" 
                                             y2="-39.71422594389904"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="43.3682557418279" 
                                             y2="-28.43165885309693"/>
                <line id="ecliptic_division" x1="0" y1="0"
                                             x2="62.74163385538669" 
                                             y2="-5.906297894248734"/>
        </g>
    </g>
</g>

<text id="output" x="10" y="190" style="font-size:3pt"></text>
<script type="application/ecmascript">
    // <![CDATA[
    var txt = document.getElementById("output");
    var r = document.getElementById("constructionLine4");
    
    function init(evt) {
        var obj;
        obj = document.getElementById("diagram");
        obj.addEventListener("click", clickButton, false);
        obj.addEventListener("mousedown", startDrag, false);
        obj.addEventListener("mousemove", doDrag, false);
    }
    
    function angle(cx, cy, ex, ey) {
      var dy = ey - cy;
      var dx = ex - cx;
      var theta = Math.atan2(dy, dx); // range (-PI, PI]
      theta *= 180 / Math.PI; // rads to degs, range (-180, 180]
      //if (theta < 0) theta = 360 + theta; // range [0, 360)
      return theta;
    }
    
    function clickButton(evt) {
        var msg = r.getAttribute("x2") + ", " +
        r.getAttribute("y2") + ", " +
        r.style.getPropertyValue("stroke") + " " +
        r.style.getPropertyValue("fill") + " " +
        angle(0, 0, r.getAttribute("x2"), r.getAttribute("y2"));
        r.setAttribute("height", "30");
        printMsg(msg); 
    }
    
    function startDrag(evt) {
        var sliderId = evt.target.parentNode.getAttribute("id");
        var svg = document.getElementById('test')
        var pt = svg.createSVGPoint();
        
        pt.x = evt.clientX; 
        pt.y = evt.clientY;
        
        var ec = document.getElementById('eclipticCenter')
        
        var svgP = pt.matrixTransform(ec.getScreenCTM().inverse());
        
        printMsg(pt.x + " " + pt.y + " | " + svgP.x + " " + svgP.y + " | " + angle(0, 0, svgP.x, svgP.y));
    }
    
    function doDrag(evt) {
        var ec = document.getElementById('cross')
        var svg = document.getElementById('test')

        var pt = svg.createSVGPoint(); 
        pt.x = evt.clientX; 
        pt.y = evt.clientY;
        
        var svgP = pt.matrixTransform(ec.getScreenCTM().inverse());
        var rotAngle = angle(0, 0, svgP.x, svgP.y)
        
        printMsg(pt.x + " " + pt.y + " | " + svgP.x + " " + svgP.y + " | " + rotAngle);
        ec.setAttribute("transform", "rotate(" + rotAngle + ")");
    }
    
    function printMsg (msg){
        txt.textContent=msg;    
    }
    // ]]>
</script>
</svg>